<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE busconfig PUBLIC
  "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
  "https://dbus.freedesktop.org/doc/busconfig.dtd">
  <busconfig>
  <policy user="echo_worker">
    <allow own="com.redhat.Yggdrasil1.Worker1.echo"/>

    <!--
    Only service user echo_worker can send messages to the Worker1.echo destination.
    -->
    <allow send_destination="com.redhat.Yggdrasil1.Worker1.echo"
      send_interface="com.redhat.Yggdrasil1.Worker1"/>
  </policy>

  <policy user="yggd">
    <!--
    The service user "yggd" used for running yggd service has to be able
    to call Dispatch D-Bus method.
    -->
    <allow send_destination="com.redhat.Yggdrasil1.Worker1.echo"
      send_interface="com.redhat.Yggdrasil1.Worker1"
      send_member="Dispatch"/>

    <!-- Only yggd can read properties of worker -->
    <allow send_destination="com.redhat.Yggdrasil1.Worker1.echo"
       send_interface="org.freedesktop.DBus.Properties"/>
  </policy>

  <policy context="default">
    <!-- Everybody should be able to introspect D-Bus API of echo worker -->
    <allow send_destination="com.redhat.Yggdrasil1.Worker1.echo"
      send_interface="org.freedesktop.DBus.Introspectable"/>
  </policy>
</busconfig>
